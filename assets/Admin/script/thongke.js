Customer = [
    { 
        id: 1,
         name: "Mikasa Chan",
         phone: "0901 234 567", 
         email: "mikasachan@gmail.com", 
         status:0,
         lichsuMuaHang:[
            {
                "id": 1,
                "stk": "12345",
                "bank": "AGB",
                ngaydat: "13/08/2024", 
                "ngayduyet": 0,
                "diachiKH": "123 Đường Lê Lợi, Quận 1, TP. HCM",
                "tongtien": 93100000,
                "status": 0,
                "name": "mikasachan",
                "phone": "0901 234 567",
                "emailKH": "mikasachan@gmail.com",
                "genderKH": "nu",
                giohang: [
                    {  
                      "hinh": "http://127.0.0.1:5500/Bonus/WebSGU/assets/User/img/watch/1-1.jpg",
                      "id": 1,
                      "ten": "Đồng Hồ Vàng Sang Trọng",
                      "gia": "47500000",
                      profit:4000000,
                      "soLuong": 1,
                      "loai": "watch"
                    },
                    {   
                      "hinh": "assets/User/img/watch/2-1.jpg",
                      "ten": "Đồng Hồ Đính Kim Cương",
                      "id": 2,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 71250000,
                      profit:7000000
                    }
                  ],
            },
            {
                "id": 2,
                "stk": "12345",
                "bank": "VCB",
                "ngaydat": "28/11/2024",
                // "ngayduyet": 0,
                "diachiKH": "123 Đường Lê Lợi, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "mikasachan",
                "phone": "0901 234 567",
                "emailKH": "mikasachan@gmail.com",
                "genderKH": "nu",
                giohang:[
                    {  
                      "hinh": "assets/User/img/watch/2-1.jpg",
                      "ten": "Đồng Hồ Đính Kim Cương",
                      "id": 2,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 71250000,
                      profit:7000000
                    },
                    {  
                      "hinh": "http://127.0.0.1:5500/Bonus/WebSGU/assets/User/img/watch/1-1.jpg",
                      "id": 1,
                      "ten": "Đồng Hồ Vàng Sang Trọng",
                      "gia": "47500000",
                      profit:4000000,
                      "soLuong": 1,
                      "loai": "watch"
                    },
                ]
            }
         ]
    },
    { id: 2, 
        status:1,
        name: "Uzumaki Naruto", 
        phone: "0912 345 678", 
        email: "naruto@gmail.com", 
        lichsuMuaHang: [
        
        {  
            "id": 36,
            "stk": "12345",
            "bank": "AGB",
            "ngaydat": "28/11/2024",
            "ngayduyet": 0,
            "diachiKH": "456 Đường Nguyễn Văn Cừ, Quận 5, TP. HCM, Việt Nam",
            "tongtien": 93100000,
            "status": 0,
            "name": "Nguyễn Hiền",
            "phone": "0912 345 678",
            "emailKH": "nguyenhien@gmail.com",
            "genderKH": "nam",
            giohang:[
                {
                  "hinh": "assets/User/img/ring/1-1.jpg",
                  "ten": "Nhẫn Đính Hôn Kim Cương",
                  "id": 6,
                  "loai": "ring",
                  "soLuong": 2,
                  "gia": 142500000,
                  profit:10000000
                }
            ]
        },
        {  
            "id": 11,
            "stk": "12345",
            "bank": "VCB",
            "ngaydat": "28/11/2024",
            "ngayduyet": 0,
            "diachiKH": "789 Đường Trần Hưng Đạo, Quận 1, TP. HCM, Việt Nam",
            "tongtien": 93100000,
            "status": 0,
            "name": "Nguyễn Hiền",
            "phone": "0912 345 678",
            "emailKH": "nguyenhien@gmail.com",
            "genderKH": "nam",
            giohang:[
                {
                  "hinh": "assets/User/img/bracelet/18-1.jpg",
                  "ten": "Vòng Tay Vàng K10",
                  "id": 18,
                  "loai": "bracelet",
                  "soLuong": 3,
                  "gia": 2100000,profit:200000
                }
            ]
        }
      ],
    },
    { id: 3,status:1, name: "Sasuke Uchiha", phone: "0978 901 234", email: "Sasuke@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 12,
                "stk": "12345",
                "bank": "VCB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "321 Đường Lê Duẩn, Quận 3, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0978 901 234",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/bracelet/18-1.jpg",
                      "ten": "Vòng Tay Vàng K10",
                      "id": 18,
                      "loai": "bracelet",
                      "soLuong": 3,
                      "gia": 2100000,
                      profit:200000
                    }
                  ]
            }
        ],
    },
    { id: 4, name: "Sakura Haruno", phone: "0923 456 789", email: "Sakura@gmail.com", 
        status:0,
        lichsuMuaHang:[
  
            {
                "id": 15,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "654 Đường Nguyễn Thị Minh Khai, Quận 3, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0923 456 789",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nu",
                giohang: [
                    {  
                      "hinh": "assets/User/img/bracelet/18-1.jpg",
                      "ten": "Vòng Tay Vàng K10",
                      "id": 18,
                      "loai": "bracelet",
                      "soLuong": 3,
                      "gia": 2100000,profit:200000
                     }
                  ],
            }
        ]
    },
    { id: 5, name: "Hinata Hyuga", phone: "0934 567 890", email: "Hinata@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 13,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "135 Đường Đinh Tiên Hoàng, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0934 567 890",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nu",
                giohang: [
                    {  
                      "hinh": "assets/User/img/watch/1-1.jpg",
                      "ten": "Đồng Hồ Vàng Sang Trọng",
                      "id": 1,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 47500000,profit:4000000
                    }
                  ],
            }
        ]
    },
    { id: 6, name: "Itachi Uchiha", phone: "0934 567 890", email: "Itachi@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 14,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "246 Đường Nguyễn Huệ, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0934 567 890",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/watch/1-1.jpg",
                      "ten": "Đồng Hồ Vàng Sang Trọng",
                      "id": 1,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 47500000,profit:4000000
                     }
                  ],
            }
        ]
    },
    { id: 7, name: "Sasori", phone: "0956 789 012", email: "Sasori@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 16,
                "stk": "12345",
                "bank": "VCB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "369 Đường Nguyễn Thái Học, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0956 789 012",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/earrings/21-1.jpg",
                      "ten": "Bông Tai 2 Trái Tim Vàng Hồng",
                      "id": 21,
                      "loai": "earring",
                      "soLuong": 1,
                      "gia": 4000000,profit:400000
                  }
                  ],
            }
        ]
      },
      { id: 8, name: "Kakashi Hatake", phone: "0967 890 123", email: "Kakashi@gmail.com",
        status:1,
        lichsuMuaHang:[
            {
                "id": 17,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "147 Đường Lê Văn Sỹ, Quận 3, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0967 890 123",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/bracelet/20-1.jpg",
                      "ten": "Vòng Tay Vàng K18",
                      "id": 20,
                      "loai": "bracelet",
                      "soLuong": 1,
                      "gia": 1400000,profit:300000
                     }
                  ],
            }
        ]
      },
      { id: 9, name: "Eren Yeager", phone: "0901 234 567", email: "Eren@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 18,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "258 Đường Võ Văn Tần, Quận 3, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0901 234 567",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/bracelet/20-1.jpg",
                      "ten": "Vòng Tay Vàng K18",
                      "id": 20,
                      "loai": "bracelet",
                      "soLuong": 1,
                      "gia": 1400000,profit:140000
                     },
                     {  
                      "hinh": "assets/User/img/watch/2-1.jpg",
                      "ten": "Đồng Hồ Đính Kim Cương",
                      "id": 2,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 71250000,profit:7000000
                  }
                  ],
            }
        ]
      },
      { id: 10, name: "Mikasa Ackerman", phone: "0903 456 789", email: "Ackerman@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 19,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "369 Đường 3/2, Quận 10, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0903 456 789",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nu",
                giohang: [
                    {  
                      "hinh": "assets/User/img/watch/2-1.jpg",
                      "ten": "Đồng Hồ Đính Kim Cương",
                      "id": 2,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 71250000,profit:7000000
                     }
                  ],
            }
        ]
      },
      { id: 11, name: "Armin Arlert", phone: "0914 567 890", email: "Armin@gmail.com", 
        status:0,
        lichsuMuaHang:[
            {
                "id": 20,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "852 Đường Trường Chinh, Quận Tân Bình, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0914 567 890",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/ring/1-1.jpg",
                      "ten": "Nhẫn Đính Hôn Kim Cương",
                      "id": 6,
                      "loai": "ring",
                      "soLuong": 1,
                      "gia": 142500000,profit:14000000
                     }
                  ],
            }
        ]
      },
      { id: 12, name: "Levi Ackerman", phone: "0925 678 901", email: "Levi@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 21,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "963 Đường Nguyễn Trãi, Quận 5, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0925 678 901",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/watch/5-1.jpg",
                      "ten": "Đồng Hồ Mặt Sapphire",
                      "id": 5,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 93100000,profit:9000000
                     },
                     {  
                      "hinh": "assets/User/img/watch/4-1.jpg",
                      "ten": "Đồng Hồ Vàng Hồng Sang Trọng",
                      "id": 4,
                      "loai": "watch",
                      "soLuong": 1,
                      "gia": 80750000,profit:8000000
                     }
                  ],
            }
        ]
      },
      { id: 13, name: "Historia Reiss", phone: "0936 789 012", email: "Historia@gmail.com",
        status:0,
        lichsuMuaHang:[
            {
                "id": 22,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "741 Đường Cách Mạng Tháng Tám, Quận 10, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0936 789 012",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nu",
                giohang: [
                    {  
                      "hinh": "assets/User/img/ring/4-1.jpg",
                      "ten": "Nhẫn Ngọc Lục Bảo và Kim Cương",
                      "id": 9,
                      "loai": "ring",
                      "soLuong": 1,
                      "gia": 104500000
                      ,profit:10000000
                     }
                  ],
            }
        ]
      },
      { id: 14, name: "Erwin Smith", phone: "0947 890 123", email: "Erwin@gmail.com"
        , status: 0,
        lichsuMuaHang:[
            {
                "id": 23,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "159 Đường Lê Lai, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0947 890 123",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/ring/4-1.jpg",
                      "ten": "Nhẫn Ngọc Lục Bảo và Kim Cương",
                      "id": 9,
                      "loai": "ring",
                      "soLuong": 1,
                      "gia": 104500000,profit:10000000
                     },
                     {  
                      "hinh": "assets/User/img/necklace/12-1.jpg",
                      "ten": "Dây Chuyền Bạc Mặt Tròn",
                      "id": 12,
                      "loai": "necklace",
                      "soLuong": 1,
                      "gia": 1200000,profit:100000
                    
                     }
                  ],
            }
        ]
      },
      { id: 15, name: "Jean Kirstein", phone: "0958 901 234", email: "Jean@gmail.com"
        , status: 0,
        lichsuMuaHang:[
            {
                "id": 24,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "753 Đường Nguyễn Đình Chiểu, Quận 3, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0958 901 234",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/necklace/12-1.jpg",
                      "ten": "Dây Chuyền Bạc Mặt Tròn",
                      "id": 12,
                      "loai": "necklace",
                      "soLuong": 1,
                      "gia": 1200000,profit:100000
                     },
                     {  
                      "hinh": "assets/User/img/necklace/11-1.jpg",
                      "ten": "Dây Chuyền Bạc Họa Tiết Móng Ngựa",
                      "id": 11,
                      "loai": "necklace",
                      "soLuong": 1,
                      "gia": 750000,profit:70000
                     },
                  ],
            }
        ]
      },
      { id: 16, name: "Sasha Blouse", phone: "0969 012 345", email: "Sasha@gmail.com"
        , status: 0,
        lichsuMuaHang:[
            {
                "id": 25,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "159 Đường Hùng Vương, Quận 5, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0969 012 345",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nu",
                giohang: [
                    {  
                      "hinh": "assets/User/img/ring/5-1.jpg",
                      "ten": "Bộ Nhẫn Cưới Bạch Kim",
                      "id": 10,
                      "loai": "ring",
                      "soLuong": 1,
                      "gia": 161500000,profit:16000000
                  },
                  ],
            }
        ]
      },
      { id: 17, name: "Connie Springer", phone: "0970 123 456", email: "Connie@gmail.com", 
        status: 0,
        lichsuMuaHang:[
            {
                "id": 26,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "258 Đường Lê Thánh Tôn, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0970 123 456",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/necklace/15-1.jpg",
                      "ten": "Dây Chuyền Bạc Dancing Stone",
                      "id": 15,
                      "loai": "necklace",
                      "soLuong": 2,
                      "gia": 450000,profit:60000
                     },
                     {  
                      "hinh": "assets/User/img/necklace/14-1.jpg",
                      "ten": "Dây Chuyền Bạc Mặt Trăng",
                      "id": 14,
                      "loai": "necklace",
                      "soLuong": 1,
                      "gia": 650000,profit:60000
                     }
                  ],
            }
        ]
      },
      { id: 18, name: "Hange Zoë", phone: "0981 234 567", email: "Hange@gmail.com"
        , status: 0,
        lichsuMuaHang:[
            {
                "id": 27,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "369 Đường Bùi Viện, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0981 234 567",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nu",
                giohang: [
                    {   
                          "hinh": "assets/User/img/necklace/13-1.jpg",
                          "ten": "Dây Chuyền Bạc Trái Tim Nhỏ",
                          "id": 13,
                          "loai": "necklace",
                          "soLuong": 1,
                          "gia": 550000,profit:50000
                     },
                     {
                      "hinh": "assets/User/img/bracelet/18-1.jpg",
                      "ten": "Vòng Tay Vàng K10",
                      "id": 18,
                      "loai": "bracelet",
                      "soLuong": 3,
                      "gia": 2100000,profit:200000
                     }
                  ],
            }
        ]
      },
      { id: 19, name: "Reiner Braun", phone: "0992 345 678", email: "Reiner@gmail.com"
        , status: 0,
        lichsuMuaHang:[
            {
                "id": 28,
                "stk": "12345",
                "bank": "AGB",
                "ngaydat": "28/11/2024",
                "ngayduyet": 0,
                "diachiKH": "456 Đường Lê Thị Riêng, Quận 1, TP. HCM, Việt Nam",
                "tongtien": 93100000,
                "status": 0,
                "name": "Nguyễn Hiền",
                "phone": "0992 345 678",
                "emailKH": "nguyenhien@gmail.com",
                "genderKH": "nam",
                giohang: [
                    {  
                      "hinh": "assets/User/img/bracelet/18-1.jpg",
                      "ten": "Vòng Tay Vàng K10",
                      "id": 18,
                      "loai": "bracelet",
                      "soLuong": 3,
                      "gia": 2100000,profit:200000
                     }
                  ],
            }
        ]}];


        function taohangthongke(Customer,product){
            console.log(Customer);
            const doanhthu=document.querySelector(".container3");
            doanhthu.innerHTML=`
            <div class="doanhthu">
            <div>id</div>
                <div>name</div>
                <div>sales volumn</div>
                <div>sales</div>
            </div>`;
            product.forEach(giohang => {
                const createrow=document.createElement("div");
                createrow.className="doanhthu";
                createrow.innerHTML+=
                `
                <div>
                    ${giohang.id}
                </div>
                <div>
                    ${giohang.ten}
                </div>
                <div>
                    ${giohang.soLuong}
                </div>
                <div>
                    ${giohang.profit} $
                </div>
                `
                doanhthu.innerHTML+=createrow.outerHTML;
            });
            const productwithhighestprofit=highest(product);
            const productwithlowestprofit=lowest(product);
            const customerwithhighestprofit=cushighest(arraycustomerwithtotalprofit(Customer));
            const customerwithlowestprofit=cuslowest(arraycustomerwithtotalprofit(Customer));
            const creatediv=document.createElement("div");
            creatediv.className=""
            creatediv.innerHTML=`
                        <div class="thongkesanpham">
                <div class="productwithhighestprofit">   
                    <div><div class="header">highest profit</div>  </div>
                    <div>
                        <div class="productinner"> 
                            <div class="divimage"><image  class="imagethongke"src="${productwithhighestprofit.hinh}"></image></div>
                            <div><div>id</div><div>${productwithhighestprofit.id}</div></div>
                            <div><div>catergory</div><div>${productwithhighestprofit.loai}</div></div>
                            <div><div>name</div><div>${productwithhighestprofit.ten}</div></div>
                            <div><div>total profit</div><div>${productwithhighestprofit.profit}</div></div>
                            <div><div>amount</div><div>${productwithhighestprofit.soLuong}</div></div>
                        </div>
                    </div>
                </div>
                <div class="productwithlowestprofit">   
                    <div><div class="header">Lowest profit</div>  </div>
                    <div>
                        <div class="productinner"> 
                            <div class="divimage"><image  class="imagethongke"src="${productwithlowestprofit.hinh}"></image></div>
                            <div><div>id</div><div>${productwithlowestprofit.id}</div></div>
                            <div><div>catergory</div><div>${productwithlowestprofit.loai}</div></div>
                            <div><div>name</div><div>${productwithlowestprofit.ten}</div></div>
                            <div><div>total profit</div><div>${productwithlowestprofit.profit}</div></div>
                            <div><div>amount</div><div>${productwithlowestprofit.soLuong}</div></div>
                        </div>
                    </div>
                </div>
            </div> 
            <div class="thongkecustom">
                <p>Customer</p>
                <div class="head">
                    <div>Customer</div><div>id</div><div>client name</div><div>amount product</div><div>amount spent</div><div>telephone</div><div>email</div>
                </div>
                <div class="cuswithlowestprofit"> 
                        <div >
                            <div class="head">Highest profit</div>
                            <div>${customerwithhighestprofit.id}</div>
                            <div>${customerwithhighestprofit.name}</div>
                            <div>${customerwithhighestprofit.totalproduct}</div>
                            <div>${customerwithhighestprofit.totalprice}</div>
                            <div>${customerwithhighestprofit.phone}</div>
                            <div>${customerwithhighestprofit.email}</div>
                        </div>
                </div>
                    <div class="cuswithhighestprofit">              
                            <div>
                                <div class="head">Lowest profit</div>
                                <div>${customerwithlowestprofit.id}</div>
                                <div>${customerwithlowestprofit.name}</div>
                                <div>${customerwithlowestprofit.totalproduct}</div>
                                <div>${customerwithlowestprofit.totalprice}</div>
                                <div>${customerwithlowestprofit.phone}</div>
                                <div>${customerwithlowestprofit.email}</div>
                            </div>
                    </div>
            </div>
            `;
            document.querySelector(".thongke").innerHTML=``;
            document.querySelector(".thongke").innerHTML+=creatediv.innerHTML;
            let a=gettotal(arraycustomerwithtotalprofit(Customer));
            document.getElementById("totalprofit").innerText=a.totalprofit;
            document.getElementById("totalproduct").innerText=a.totalproduct;
            document.getElementById("totaluser").innerText=a.totaluser;
            document.getElementById("totalprice").innerText=a.totalprice;
        }
function gettotal(Customer){
    let sumprofit=0;
    let sumproduct=0;
    let sumprice=0;
    Customer.forEach(customer=>{
    sumprofit+=customer.totalprofit;
    sumproduct+=customer.totalproduct;
    sumprice+=customer.totalprice;

    })
    return {
    totalprofit:sumprofit,
    totalproduct:sumproduct,
    totalprice:sumprice,
    totaluser:Customer.length

    }
}
function cushighest(Customer){
    let max=-Infinity;
    let cus;
    Customer.forEach(customer=>{
        if(customer.totalprofit>max){
            max=customer.totalprofit;
            cus=customer;
        }
    })
    return cus;
}  

function cuslowest(Customer){
    let min=Infinity;
    let cus;
    Customer.forEach(customer=>{
        if(min>customer.totalprofit){
            min=customer.totalprofit;
            cus=customer;
        }
    })
    return cus;
}    
    function highest(product){
        let max=-Infinity;
        let productwithmax;
        product.forEach(product=>{
            if(product.profit>max){
                max=product.profit;
                productwithmax=product
            }
        })
        return productwithmax;
    }
    function lowest(product){
        let productwithmin;
        let min=Infinity;
        product.forEach(product=>{
            if(product.profit<min){
                min=product.profit;
                productwithmin=product;
            }
        })
        return productwithmin;
    }

  function checktimeday(receiptime){
    let arraycopy=JSON.parse(JSON.stringify(receiptime));
    receipt=arraycopy.split("/");

    if(receipt[2].replace(/^0+/, '')<year){
         return false;
    } 
    if(receipt[2].replace(/^0+/, '')>yearsecond){
        return false;
    }
    if(receipt[2].replace(/^0+/, '')<yearsecond && receipt[2].replace(/^0+/, '')>year){
        return true;
    }
    if(receipt[1].replace(/^0+/, '')<month && receipt[2].replace(/^0+/, '')==year){
        return false;
    }
    if(receipt[1].replace(/^0+/, '')>monthsecond && receipt[2].replace(/^0+/, '')==yearsecond){
        return false;
    }
    if(receipt[0].replace(/^0+/, '')<day && receipt[1].replace(/^0+/, '')==month && receipt[2].replace(/^0+/, '')==year){
        return false;
    }
    if(receipt[0].replace(/^0+/, '')>daysecond && receipt[1].replace(/^0+/, '')==monthsecond &&receipt[2].replace(/^0+/, '')==yearsecond){
        return false;
    }
    return true; 
}
let day=1;
let daysecond=10;
let yearsecond=2024;
let year=2024
let monthsecond=11;
let month=8
//lấy mảng customer mới với lịch sử mua hàng thỏa điều kiện 
function arraycustomer(Customer){
    return Customer.map(customer => {
        const filteredlichsuMuaHangs = customer.lichsuMuaHang.filter(lichsuMuaHang => {
            return checktimeday(lichsuMuaHang.ngaydat);
        }
        );
        if (filteredlichsuMuaHangs.length > 0) {
            return { 
                ...customer, 
                lichsuMuaHang: filteredlichsuMuaHangs
            };
        }
    }).filter(customer => customer); 
}
//khách hàng với tổng doanh thu,tổng product
function arraycustomerwithtotalprofit(Customer){
    // let deepCopy=arraycustomer(Customer);
    const array = JSON.parse(JSON.stringify(Customer));
    array.forEach(customer=>{
        customer.lichsuMuaHang.forEach(lichsuMuaHang=>{
            customer.totalprice=0;
            customer.totalproduct=0;
            customer.totalprofit=0;
            lichsuMuaHang.giohang.forEach(product=>{
                customer.totalprofit+=product.soLuong*product.profit;
                customer.totalproduct+=product.soLuong;
                customer.totalprice+=product.soLuong*parseInt(product.gia);
            })
        })
    })
    return array;
}
function bang(){

}

// lấy mảng product mới id phân biệt
//   function aggregateCartItems(customers) {
//     const aggregatedItems = {};
//     customers.forEach(customer => {
//         customer.lichsuMuaHang.forEach(order => {
//             let uni=new Set();
//             let i=0;
//             order.giohang.forEach(item => {
//                 uni.add(item.id);
//                 if (uni.has(item.id)) {
//                     aggregatedItems[i].soLuong += item.soLuong;
//                     aggregatedItems[i].profit=item.profit*item.soLuong
//                     aggregatedItems[i].gia=item.gia*item.soLuong
//                 } else {
//                     aggregatedItems[i] = { ...item };
//                     aggregatedItems[i].profit=item.profit*item.soLuong;
//                     aggregatedItems[i].gia=item.gia*item.soLuong;
//                     aggregatedItems[i].soLuong+=product.soLuong
//                     i++;
//                 }
//             });
//         });
//     });
//     return Object.values(aggregatedItems);
//   }
function aggregateCartItems(customers) {
    const aggregatedItems = {};
    customers.forEach(customer => {
        customer.lichsuMuaHang.forEach(order => {
            order.giohang.forEach(item => {
                if (aggregatedItems[item.id]) {
                    aggregatedItems[item.id].soLuong += item.soLuong;
                    aggregatedItems[item.id].profit += item.profit * item.soLuong; 
                    aggregatedItems[item.id].gia += item.gia * item.soLuong;
                } else {
                    aggregatedItems[item.id] = { 
                        ...item, 
                        soLuong: item.soLuong, 
                        profit: item.profit * item.soLuong, 
                        gia: item.gia * item.soLuong 
                    };
                }
            });
        });
    });
    return Object.values(aggregatedItems);
}
function gettimefirst(){
    const time=document.getElementById("timefirst").value;
    if(time){
        day=parseInt(time.split("-")[2].replace(/^0+/, ''),10);
        month=parseInt(time.split("-")[1].replace(/^0+/, ''),10);
        year=parseInt(time.split("-")[0].replace(/^0+/, ''),10);
    }
}
function gettimesecond(){
    const time=document.getElementById("timesecond").value;
    if(time){
        daysecond=parseInt(time.split("-")[2].replace(/^0+/, ''),10);
        monthsecond=parseInt(time.split("-")[1].replace(/^0+/, ''),10);
        yearsecond=parseInt(time.split("-")[0].replace(/^0+/, ''),10);
    }
    if(time && document.getElementById("timefirst").value){
        if(yearsecond<year){
            alert("Bạn nhập sai năm");
        }
        if(yearsecond==year && monthsecond<month){
            alert("Bạn nhập sai tháng")
        }
        if(yearsecond==year && monthsecond==month && daysecond<day){
            alert("Bạn nhập sai ngày");
        }
    console.log(aggregateCartItems(Customer));
    taohangthongke(arraycustomer(Customer),aggregateCartItems(Customer));

    }
}
// function getcurrentyear(){
//     const currentday=new Date();
//     year=currentday.getFullYear();
//     day=1;
//     month=1;
//     yearsecond=year+1;
//     daysecond=1;
//     monthsecond=1;
// }
// getcurrentyear();
    year=2024;
    day=1;
    month=1;
    yearsecond=year+1;
    daysecond=1;
    monthsecond=1;
taohangthongke(arraycustomer(Customer),aggregateCartItems(Customer));